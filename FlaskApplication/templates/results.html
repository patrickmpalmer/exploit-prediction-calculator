<!DOCTYPE HTML>
<html>
<head>
<title>Results</title>
<script src="https://kit.fontawesome.com/1b65f66586.js" crossorigin="anonymous"></script>  
<script>
window.onload = function () {

// results = {
//   "base": 4.3,
//   "impact": 1.4,
//   "exploitability": 2.8,
//   "temporal": 4,
//   "environmental": 4,
//   "modified": 1.8,
//   "overall": 4,
//   "threat": 3.3
// };


var chart = new CanvasJS.Chart("chartContainer", {
  animationEnabled: true,
  theme: "dark2",
  title:{
    text:"Exploitability Likelihood"
  },
  axisY2:{
    minimum: 0,
    maximum: 100,
    interval: 10
  },
  data: [{
    type: "bar",
    name: "companies",
    axisYType: "secondary",
    dataPoints: [
      { y: {{ results.threat }}, label: "threat level" }
    ]
  }]
});
setColor(chart);
chart.render();

var chart1 = new CanvasJS.Chart("chartContainer1", {
  animationEnabled: true,
  theme: "dark2", // "light1", "light2", "dark1", "dark2"
  title:{
    text: "Base Scores"
  },
  axisY: {
    minimum: 0,
    maximum: 10
  },
  data: [{        
    type: "column",  
    dataPoints: [      
      { y: {{results.base }}, label: "base" },
      { y: {{results.impact }},  label: "impact" },
      { y: {{results.exploitability}},  label: "exploitability" }
    ]
  }]
});
chart1.render();

// var chart2 = new CanvasJS.Chart("chartContainer2", {
//   animationEnabled: true,
//   theme: "dark2", // "light1", "light2", "dark1", "dark2"
//   title:{
//     text: "Temporal"
//   },
//   axisY: {
//     minimum: 0,
//     maximum: 10
//   },
//   data: [{        
//     type: "column",  
//     dataPoints: [      
//       { y: {{results.temporal}}, label: "temporal" }
//     ]
//   }]
// });
// chart2.render();

// var chart3 = new CanvasJS.Chart("chartContainer3", {
//   animationEnabled: true,
//   theme: "dark2", // "light1", "light2", "dark1", "dark2"
//   title:{
//     text: "Environmental"
//   },
//   axisY: {
//     minimum: 0,
//     maximum: 10
//   },
//   data: [{        
//     type: "column",  
//     dataPoints: [      
//       { y: {{results.environmental}}, label: "environmental" },
//       { y: {{results.modified}},  label: "modified impact" }
//     ]
//   }]
// });
// chart3.render();

var chart4 = new CanvasJS.Chart("chartContainer4", {
  animationEnabled: true,
  theme: "dark2", // "light1", "light2", "dark1", "dark2"
  title:{
    text: "Overall"
  },
  axisY: {
    minimum: 0,
    maximum: 10
  },
  data: [{        
    type: "column",  
    dataPoints: [      
      { y: {{results.overall}}, label: "overall" }
    ]
  }]
});
chart4.render();

function setColor(chart){
  dataSeries = chart.options.data[0];
  if(dataSeries.dataPoints[0].y >= 0 && dataSeries.dataPoints[0].y <= 33.3){
    dataSeries.dataPoints[0].color = 'rgb(35, 136, 35)';
    document.getElementById("description").innerHTML = "The threat level has been determined to be low. Potential software vulnerabilities are not very severe. Action may not be necessary.";
  }
  else if(dataSeries.dataPoints[0].y >= 33.4 && dataSeries.dataPoints[0].y <= 66.6){
    dataSeries.dataPoints[0].color = 'rgb(255, 191, 0)';
    document.getElementById("description").innerHTML = "The threat level has been determined to be moderate. Potential software vulnerabilities could be severe. Action is likely necessary.";
  } 
  else{
    dataSeries.dataPoints[0].color = 'rgb(210, 34, 45)';
    document.getElementById("description").innerHTML = "The threat level has been determined to be high. Potential software vulnerabilities are very severe. Action is necessary.";
  }
}

}
</script>
</head>
<body style="background-color: rgb(50, 55, 58);">
<div style="height: 100px; width: 100%; display: inline-block;">
  <button onclick="window.print()" style="height: 75px; width: 170px; background-color: rgb(144, 237, 143); border-radius: 10px; border-style: none; float: left;">
    <p style="font-size: 1.1em;">
      <i class="fas fa-file fa-2x" style="vertical-align: middle;"></i>
      &nbsp save or print results
    </p>
  </button>
  <button onclick="window.location.href = '/';" style="height: 75px; width: 170px; background-color: rgb(61, 148, 247); border-radius: 10px; border-style: none; float: right;">
    <p style="font-size: 1.1em;">
      <i class="fas fa-redo-alt fa-2x" style="vertical-align: middle;"></i>
      &nbsp run another calculation
    </p>
  </button>
</div>
<div id="chartContainer" style="height: 370px; width: 100%;"></div>
<div id="description" style="height: 200px; width: 100%; text-align: center; color: white; font-size: 1.5em; font-family: 'Helvetica'; line-height: 100px">loading...</div>
<div style="width: 100%; padding-left: 40px;">
  <div style="width: 250px; height: 200px; float: left;">
    <div style="width: 100%; height: 40px; line-height: 30px; text-align: center; color: white;">threat score</div>
    <div style="width: 100%; height: 30px;">
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">low:</div>
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">0 - 33.3%</div>
      <div style="width: 60px; height: 30px; float: right; background-color: rgb(35, 136, 35);"></div>
    </div>
    <div style="width: 100%; height: 10px;"></div>
    <div style="width: 100%; height: 30px;">
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">medium:</div>
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">33.4 - 66.6%</div>
      <div style="width: 60px; height: 30px; float: right; background-color: rgb(255, 191, 0);"></div>
    </div>
    <div style="width: 100%; height: 10px;"></div>
    <div style="width: 100%; height: 30px;">
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">high:</div>
      <div style="width: 33%; height: 30px; float: left; line-height: 30px; color: white; font-size: 0.9em;">66.7 - 100%</div>
      <div style="width: 60px; height: 30px; float: right; background-color: rgb(210, 34, 45);"></div>
    </div>
  </div>
  <div id="description" style="height: 200px; width: 84%; text-align: center; color: white; font-size: 1.4em; font-family: 'Helvetica'; line-height: 100px; float: left;">loading...</div>
</div>

<div id="chartContainer1" style="height: 370px; width: 49.4%; display: inline-block;"></div>
<!-- <div id="chartContainer2" style="height: 370px; width: 24.5%; display: inline-block;"></div>
<div id="chartContainer3" style="height: 370px; width: 24.5%; display: inline-block;"></div> -->
<div id="chartContainer4" style="height: 370px; width: 49.4%; display: inline-block;"></div>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</body>
</html>